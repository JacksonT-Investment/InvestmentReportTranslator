# 研报解读助手 - 测试指南

## 🎯 测试目标

验证研报解读助手的完整功能流程：
1. ✅ 文件上传功能
2. ✅ API调用功能
3. ✅ 文本提取功能
4. ✅ AI分析功能
5. ✅ 结果展示功能

## 🧪 测试方法

### 方法一：快速功能测试（推荐）

使用提供的测试文件，无需配置Kimi API Key：

#### 1. 启动测试服务器
```bash
node test-simple.js
```

#### 2. 打开测试页面
在浏览器中访问：
```
http://localhost:3001/test-frontend.html
```

#### 3. 上传测试文件
- 选择一个PDF、Word或图片文件
- 拖拽或点击上传
- 观察处理过程

#### 4. 查看测试结果
- 系统会显示测试成功的状态
- 2秒后自动跳转到结果页面
- 查看完整的分析结果

### 方法二：API直接测试

使用curl或Postman测试API：

#### 1. 确保服务器运行
```bash
node test-simple.js
```

#### 2. 测试健康检查
```bash
curl http://localhost:3001/api/health
```

预期返回：
```json
{"status":"ok","timestamp":"2024-01-13T..."}
```

#### 3. 测试分析API
```bash
curl -X POST http://localhost:3001/api/analyze \
  -F "report=@your-test-file.pdf"
```

### 方法三：完整版本测试

如果您有Kimi API Key，可以测试完整功能：

#### 1. 配置环境变量
```bash
cp .env.example .env
# 编辑.env文件，填入您的Kimi API Key
```

#### 2. 安装依赖
```bash
npm install
```

#### 3. 启动完整版本
```bash
./start.sh
# 或
node server.js
```

#### 4. 测试真实分析
上传真实的研报文件，系统将：
- 提取文本内容
- 调用Kimi API
- 返回真实分析结果

## 📁 测试文件

### 推荐测试文件

1. **PDF文件**
   - 任意券商研报PDF
   - 文件大小 < 50MB

2. **Word文档**
   - .doc或.docx格式
   - 包含表格和图片的文档

3. **图片文件**
   - JPG、PNG格式
   - 研报截图或扫描件
   - 清晰度越高越好

### 创建测试文件

如果没有现成的研报文件，可以创建一个简单的文本文件：

```bash
# 创建测试研报
echo "测试券商研究报告

【核心观点】
本报告分析了当前市场情况。数据显示，市场指数上涨了15%，交易量达到1000亿元。

【详细分析】
我们认为，未来市场将继续保持增长态势。主要基于以下原因：
1. 经济数据持续向好
2. 政策支持力度加大  
3. 市场情绪积极

【投资建议】
建议投资者关注科技股和金融股的投资机会。" > test-report.txt
```

## 🔍 测试检查清单

### 功能测试

- [ ] 文件选择对话框正常打开
- [ ] 拖拽上传功能正常工作
- [ ] 文件信息显示正确（文件名、大小）
- [ ] 上传进度条动画流畅
- [ ] API调用成功（查看控制台日志）
- [ ] 结果页面正确显示
- [ ] 侧边导航功能正常
- [ ] 复制功能可用

### 兼容性测试

- [ ] Chrome浏览器
- [ ] Firefox浏览器  
- [ ] Safari浏览器
- [ ] Edge浏览器
- [ ] 移动端浏览器

### 文件格式测试

- [ ] PDF文件 (.pdf)
- [ ] Word文档 (.doc, .docx)
- [ ] 图片文件 (.jpg, .png)
- [ ] 大文件 (>10MB)
- [ ] 小文件 (<1MB)

## 🐛 常见问题

### 问题1: 无法连接到服务器
**症状**: 浏览器显示"无法连接"或"连接被拒绝"

**解决方案**:
```bash
# 检查服务器是否运行
ps aux | grep node

# 如果没有运行，启动服务器
node test-simple.js

# 或检查端口是否被占用
lsof -i :3001
```

### 问题2: 文件上传失败
**症状**: 上传后没有反应或显示错误

**解决方案**:
1. 检查文件格式是否支持
2. 检查文件大小是否超过50MB
3. 查看浏览器控制台错误信息
4. 检查网络连接

### 问题3: API调用超时
**症状**: 长时间等待后显示超时错误

**解决方案**:
1. 检查服务器是否响应缓慢
2. 增加API超时时间
3. 检查是否有大文件处理

### 问题4: 结果显示异常
**症状**: 结果页面显示不完整或格式错误

**解决方案**:
1. 检查浏览器控制台错误
2. 清除浏览器缓存
3. 刷新页面重试

## 📊 测试结果记录

### 测试报告模板

```markdown
# 测试报告 - 日期

## 测试环境
- 操作系统: [Windows/Mac/Linux]
- 浏览器: [Chrome/Firefox/Safari/Edge] 版本
- 服务器: [本地/远程]

## 测试文件
- 文件名: [文件名]
- 格式: [PDF/Word/图片]
- 大小: [文件大小]

## 测试结果
- ✅ 文件上传: [通过/失败]
- ✅ API调用: [通过/失败]
- ✅ 结果显示: [通过/失败]
- ✅ 功能完整: [通过/失败]

## 问题记录
- [问题描述]
- [截图或日志]
- [解决方案]
```

## 🎯 性能测试

### 响应时间测试

记录以下操作的耗时：
- 文件上传: ___秒
- API处理: ___秒  
- 结果返回: ___秒
- 页面渲染: ___秒

### 并发测试

使用Apache Bench测试并发性能：
```bash
# 安装ab工具（Apache Bench）
# 在Ubuntu/Debian上: sudo apt-get install apache2-utils
# 在macOS上: ab 已预装

# 测试并发请求
ab -n 10 -c 2 -T 'multipart/form-data' -p test-data.txt http://localhost:3001/api/analyze
```

## 📱 移动端测试

### 测试要点
- [ ] 文件选择功能
- [ ] 拖拽上传（不支持则隐藏提示）
- [ ] 页面布局适配
- [ ] 触摸交互响应
- [ ] 加载速度

### 推荐测试设备
- iPhone (Safari)
- Android手机 (Chrome)
- iPad (Safari)

## 🔒 安全测试

### 文件安全
- [ ] 上传可执行文件（应被拒绝）
- [ ] 上传超大文件（应被拒绝）
- [ ] 上传恶意文件（应被处理或拒绝）

### API安全
- [ ] 跨域请求测试
- [ ] API速率限制测试
- [ ] 输入验证测试

## 📈 测试覆盖率

### 代码覆盖
使用工具检查代码覆盖率：
```bash
# 安装nyc（Istanbul）
npm install -g nyc

# 运行带覆盖率的测试
nyc node test-simple.js

# 查看覆盖率报告
nyc report
```

## 🎉 测试完成

当所有测试项都通过时，您的研报解读助手就可以投入使用了！

**下一步建议：**
1. 部署到生产环境
2. 添加用户认证系统
3. 集成支付功能
4. 添加监控和日志

祝测试顺利！🚀